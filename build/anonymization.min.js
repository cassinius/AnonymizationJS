!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(t){var r=n(1),i=n(3),a=n(4),o=n(5),s=n(6),c=n(8),h="undefined"!=typeof window?window:t;h.$A={config:{adults:s.CONFIG,houses:c.CONFIG},genHierarchy:{Category:r.StringGenHierarchy,Range:r.ContGenHierarchy},IO:{CSVIN:i.CSVInput,CSVOUT:a.CSVOutput},algorithms:{Sangreea:o.SaNGreeA}},e.exports=h.$A}).call(t,function(){return this}())},function(e,t,n){"use strict";var r=n(2),i=function(){function e(e){this.file=e,this._entries={},this._nr_levels=0;var t;t="undefined"==typeof window?JSON.parse(r.readFileSync(e).toString()):JSON.parse(e),this._name=t.name,this.readFromJson(t)}return e.prototype.readFromJson=function(e){var t=0;for(var n in e.entries){var r=e.entries[n],i=+r.level;0===i&&t++,i>this._nr_levels&&(this._nr_levels=i);var a={name:r.name,gen:r.gen,level:r.level};this._entries[n]=a}if(1!==t)throw new Error("JSON invalid. Level 0 must contain exactly 1 entry.")},e.prototype.nrLevels=function(){return this._nr_levels},e.prototype.getEntries=function(){return this._entries},e.prototype.getLevelEntry=function(e){return this._entries[e]?this._entries[e].level:void 0},e.prototype.getGeneralizationOf=function(e){return this._entries[e]?this._entries[e].gen:void 0},e.prototype.getName=function(e){return this._entries[e].name},e}();t.StringGenHierarchy=i;var a=function(){function e(e,t,n){if(this._name=e,this._min=t,this._max=n,t>n)throw new Error("Range invalid. Min greater than Max.");if(t===n)throw new Error("Range invalid. Min equals Max.")}return e.prototype.genCostOfRange=function(e,t){if(e>t)throw new Error("Cannot generalize to negative range.");if(e<this._min)throw new Error("Cannot generalize span. From parameter less than range min.");if(t>this._max)throw new Error("Cannot generalize span. To parameter greater than range max.");return(t-e)/(this._max-this._min)},e}();t.ContGenHierarchy=a},function(e,t){},function(e,t,n){"use strict";var r=n(2),i=n(2),a=function(){function e(e){this._SEP=new RegExp(e.SEPARATOR,e.SEP_MOD),this._TRIM=new RegExp(e.TRIM,e.TRIM_MOD)}return e.prototype.readCSVFromFile=function(e){return r.readFileSync(e).toString().split("\n")},e.prototype.readCSVFromURL=function(e,t){var n;"undefined"!=typeof window?(n=new XMLHttpRequest,n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.responseText.split("\n"))},n.open("GET",e,!0),n.setRequestHeader("Content-Type","text/csv; charset=UTF-8"),n.send()):this.retrieveRemoteFile(e,t)},e.prototype.retrieveRemoteFile=function(e,t){if("function"!=typeof t)throw new Error("Provided callback is not a function.");return i.get(e,function(e){var n="";e.on("data",function(e){n+=e}),e.on("end",function(){t(n.toString().split("\n"))})})},e}();t.CSVInput=a},function(e,t,n){"use strict";var r=n(2),i=function(){function e(e){this._SEP=new RegExp(e.SEPARATOR,e.SEP_MOD),this._TRIM=new RegExp(e.TRIM,e.TRIM_MOD)}return e.prototype.outputCSVToFile=function(e,t){r.writeFileSync("./test/io/test_output/"+e+".csv",t)},e}();t.CSVOutput=i},function(e,t,n){"use strict";var r=n(1),i=n(6),a=n(7),o=n(4);!function(e){e[e.CONTINUOUS=0]="CONTINUOUS",e[e.CATEGORICAL=1]="CATEGORICAL"}(t.HierarchyType||(t.HierarchyType={}));var s=(t.HierarchyType,function(){function e(e,t){if(void 0===e&&(e="default"),this._name=e,this.config=t,this._cont_hierarchies={},this._cat_hierarchies={},this._range_hierarchy_indices={},this._categorical_hierarchy_indices={},this._config=t||i.CONFIG,""===this._config.INPUT_FILE)throw new Error("Input file cannot be an empty string");if(this._config.NR_DRAWS<0)throw new Error("Options invalid. Nr_draws can not be negative.");if(this._config.EDGE_MIN<0)throw new Error("Options invalid. Edge_min can not be negative.");if(this._config.EDGE_MAX<0)throw new Error("Options invalid. Edge_max can not be negative.");if(this._config.EDGE_MAX<this._config.EDGE_MIN)throw new Error("Options invalid. Edge_min cannot exceed edge_max.");this._graph=new a.core.BaseGraph(this._name),this._perturber=new a.perturbation.SimplePerturber(this._graph),this._SEP=new RegExp(this._config.SEPARATOR,this._config.SEP_MOD),this._TRIM=new RegExp(this._config.TRIM,this._config.TRIM_MOD),this._csvOUT=new o.CSVOutput(this._config)}return e.prototype.getConfig=function(){return this._config},e.prototype.getContHierarchies=function(){return this._cont_hierarchies},e.prototype.getCatHierarchies=function(){return this._cat_hierarchies},e.prototype.getContHierarchy=function(e){return this._cont_hierarchies[e]},e.prototype.getCatHierarchy=function(e){return this._cat_hierarchies[e]},e.prototype.setContHierarchy=function(e,t){this._cont_hierarchies[e]=t},e.prototype.setCatHierarchy=function(e,t){this._cat_hierarchies[e]=t},e.prototype.instantiateGraph=function(e,t){void 0===t&&(t=!0);var n=e.shift().trim().replace(this._TRIM,"").split(this._SEP);this.instantiateRangeHierarchies(e,n),this.readCSV(e,n,this._graph),t&&this._perturber.createRandomEdgesSpan(this._config.EDGE_MIN,this._config.EDGE_MAX,!1)},e.prototype.instantiateRangeHierarchies=function(e,t){var n=this,i=(Object.keys(this._cont_hierarchies),Object.keys(this._config.GEN_WEIGHT_VECTORS[this._config.VECTOR].range));if(!(i.length<1)){t.forEach(function(e,t){i.indexOf(e)!==-1&&(n._range_hierarchy_indices[e]=t)});var a={};i.forEach(function(e){a[e]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}});for(var o=NaN,s=0;s<e.length;s++)if(e[s]){var c=e[s].trim().replace(this._TRIM,"").split(this._SEP);i.forEach(function(e){o=parseFloat(c[n._range_hierarchy_indices[e]]),o<a[e].min&&(a[e].min=o),o>a[e].max&&(a[e].max=o)})}i.forEach(function(e){var t=new r.ContGenHierarchy(e,a[e].min,a[e].max);n.setContHierarchy(t._name,t)})}},e.prototype.readCSV=function(e,t,n){var r=Object.keys(this._cont_hierarchies),i=Object.keys(this._cat_hierarchies),a={};t.forEach(function(e,t){r.indexOf(e)!==-1&&(a[t]=e)});var o={};t.forEach(function(e,t){i.indexOf(e)!==-1&&(o[t]=e)});var s=t.indexOf(this._config.TARGET_COLUMN);if(s<0)throw new Error("Target column does not exist... aborting.");for(var c=this._config.NR_DRAWS,h=0;h<c;h++)if(e[h]){var _=e[h].trim().replace(this._TRIM,"").split(this._SEP),u=!0;for(var f in o){var g=this.getCatHierarchy(o[f]);g&&!g.getLevelEntry(_[f])&&(u=!1)}for(var f in a){this.getContHierarchy(a[f]);+_[f]!==+_[f]&&(u=!1)}if(u){var p=this._graph.addNodeByID(""+h);for(var f in o)p.setFeature(o[f],_[f]);for(var f in a)p.setFeature(a[f],+_[f]);p.setFeature(this._config.TARGET_COLUMN,_[s])}else c++}},e.prototype.constructPreprocCSV=function(e){var t="",n=this._graph.getNodes(),r=null,i=0;Object.keys(this._cont_hierarchies).forEach(function(e){t+=e+", "}),Object.keys(this._cat_hierarchies).forEach(function(e){t+=e+", "}),t+=this._config.TARGET_COLUMN+"\n",e=e||{};var a=e.random,o=parseFloat(e.prob),s=e.feat,c=e.value,h=e.group,_=0|+e.nr_bins;console.log("nr bins: "+_);var u=Number.NEGATIVE_INFINITY;for(var f in this._graph.getNodes()){if(r=n[f],null!=o&&null!=s&&null!=c){if(a&&Math.random()<o){i++;continue}if(parseFloat(c)!==parseFloat(c)){if(Math.random()<o&&r.getFeature(s)===c){i++;continue}}else if(h){var g=this.getContHierarchy(s)._min,p=this.getContHierarchy(s)._max,l=p-g,E=l/_,v=(+r.getFeature(s)-g)/E|0;u=v>u?v:u,r.setFeature(s,v)}else if(Math.random()<o&&r.getFeature(s)>c){i++;continue}}Object.keys(this._cont_hierarchies).forEach(function(e){t+=r.getFeature(e)+", "}),Object.keys(this._cat_hierarchies).forEach(function(e){t+=r.getFeature(e)+", "}),t+=r.getFeature(this._config.TARGET_COLUMN)+"\n"}return console.log("Max bin used: "+u),console.log("Eliminated "+i+" rows from a DS of "+this._graph.nrNodes()+" rows."),t},e.prototype.outputPreprocCSV=function(e,t){var n=this.constructPreprocCSV(t);this._csvOUT.outputCSVToFile(e,n)},e.prototype.constructAnonymizedCSV=function(){var e=this,t="";Object.keys(this._cont_hierarchies).forEach(function(e){t+=e+", "}),Object.keys(this._cat_hierarchies).forEach(function(e){t+=e+", "}),t+=this._config.TARGET_COLUMN+"\n";for(var n in this._clusters){var r=this._clusters[n],i=r.nodes;for(var a in i)Object.keys(this._cont_hierarchies).forEach(function(n){var i=r.gen_ranges[n];if(i[0]===i[1])t+=i[0]+", ";else if(e._config.AVERAGE_OUTPUT_RANGES){var a=(i[0]+i[1])/2;t+=a+", "}else t+="["+i[0]+" - "+i[1]+"], "}),Object.keys(this._cat_hierarchies).forEach(function(n){var i=e._cat_hierarchies[n];t+=i.getName(r.gen_feat[n])+", "}),t+=i[a].getFeature(this._config.TARGET_COLUMN)+"\n"}return t},e.prototype.outputAnonymizedCSV=function(e){var t=this.constructAnonymizedCSV();this._csvOUT.outputCSVToFile(e,t)},e.prototype.anonymizeGraph=function(){var e,t,n,r,i,a,o,s,c,h=this,_=[],u=this._graph.getNodes(),f=Object.keys(u),g={},p=Object.keys(u).length;for(s=0;s<f.length;s++)if(e=u[f[s]],!g[e.getID()]){var l={nodes:{},gen_feat:{},gen_ranges:{}};for(Object.keys(this._cat_hierarchies).forEach(function(t){l.gen_feat[t]=e.getFeature(t)}),Object.keys(this._cont_hierarchies).forEach(function(t){l.gen_ranges[t]=[e.getFeature(t),e.getFeature(t)]}),l.nodes[e.getID()]=e,g[e.getID()]=!0,p--;Object.keys(l.nodes).length<this._config.K_FACTOR&&p;){for(o=Number.POSITIVE_INFINITY,c=s+1;c<f.length;c++)t=u[f[c]],g[t.getID()]||(r=this.calculateGIL(l,t),i=this._config.BETA>0?this.calculateSIL(l,t):0,a=this._config.ALPHA*r+this._config.BETA*i,a<o&&(o=a,n=t));l.nodes[n.getID()]=n,this.updateLevels(l,n),Object.keys(this._cont_hierarchies).forEach(function(e){h.updateRange(l.gen_ranges[e],n.getFeature(e))}),g[n.getID()]=!0,p--}_.push(l)}console.log("Built "+_.length+" clusters."),this._clusters=_},e.prototype.calculateGIL=function(e,t){return this.calculateCatCosts(e,t)+this.calculateContCosts(e,t)},e.prototype.calculateSIL=function(e,t){var n=this._graph.nrNodes()-2,r=[],i=t.reachNodes().map(function(e){return e.node.getID()});for(var a in e.nodes){var o=n,s=e.nodes[a].reachNodes().map(function(e){return e.node.getID()});for(var c in s){var h=s[c];h!==t.getID()&&i.indexOf(h)!==-1&&--o}r.push(o/n)}return r.reduce(function(e,t){return e+t},0)/r.length},e.prototype.calculateCatCosts=function(e,t){var n=0;for(var r in this._cat_hierarchies){for(var i=this.getCatHierarchy(r),a=e.gen_feat[r],o=t.getFeature(r),s=i.getLevelEntry(a),c=i.getLevelEntry(o);a!==o;)o=i.getGeneralizationOf(o),c=i.getLevelEntry(o),s>c&&(a=i.getGeneralizationOf(a),s=i.getLevelEntry(a));var h=this._config.GEN_WEIGHT_VECTORS[this._config.VECTOR].categorical;n+=h[r]*((i.nrLevels()-s)/i.nrLevels())}var _=Object.keys(this._cat_hierarchies).length;return _>1?n/_:n},e.prototype.calculateContCosts=function(e,t){var n=this,i=0,a=this._config.GEN_WEIGHT_VECTORS[this._config.VECTOR].range;Object.keys(this._cont_hierarchies).forEach(function(o){var s=n.getContHierarchy(o),c=e.gen_ranges[o],h=n.expandRange(c,t.getFeature(o)),_=s instanceof r.ContGenHierarchy?s.genCostOfRange(h[0],h[1]):0;i+=a[o]+_});var o=Object.keys(this._cont_hierarchies).length;return o>1?i/o:i},e.prototype.updateLevels=function(e,t){for(var n in this._cat_hierarchies){for(var r=this.getCatHierarchy(n),i=e.gen_feat[n],a=t.getFeature(n),o=r.getLevelEntry(i),s=r.getLevelEntry(a);i!==a;)a=r.getGeneralizationOf(a),s=r.getLevelEntry(a),o>s&&(i=r.getGeneralizationOf(i),o=r.getLevelEntry(i));e.gen_feat[n]=i}},e.prototype.expandRange=function(e,t){var n=t<e[0]?t:e[0],r=t>e[1]?t:e[1];return[n,r]},e.prototype.updateRange=function(e,t){e[0]<e[0]?t:e[0],e[1]=t>e[1]?t:e[1]},e}());t.SaNGreeA=s},function(e,t){"use strict";var n={REMOTE_URL:"http://berndmalle.com/anonymization/adults",REMOTE_TARGET:"education",INPUT_FILE:"./test/io/test_input/adult_data.csv",TRIM:"\\s+",TRIM_MOD:"g",SEPARATOR:",",SEP_MOD:"",TARGET_COLUMN:"marital-status",AVERAGE_OUTPUT_RANGES:!0,NR_DRAWS:500,RANDOM_DRAWS:!1,EDGE_MIN:2,EDGE_MAX:10,K_FACTOR:7,ALPHA:1,BETA:0,GEN_WEIGHT_VECTORS:{equal:{categorical:{workclass:1/13,"native-country":1/13,sex:1/13,race:1/13,relationship:1/13,occupation:1/13,income:1/13},range:{age:1/13,fnlwgt:1/13,"education-num":1/13,"capital-gain":1/13,"capital-loss":1/13,"hours-per-week":1/13}},emph_race:{categorical:{workclass:.01,"native-country":.01,sex:.01,race:.88,relationship:.01,occupation:.01,income:.01},range:{age:.01,fnlwgt:.01,"education-num":.01,"capital-gain":.01,"capital-loss":.01,"hours-per-week":.01}},emph_age:{categorical:{workclass:.01,"native-country":.01,sex:.01,race:.01,relationship:.01,occupation:.01,income:.01},range:{age:.88,fnlwgt:.01,"education-num":.01,"capital-gain":.01,"capital-loss":.01,"hours-per-week":.01}}},VECTOR:"equal"};t.CONFIG=n},function(e,t){e.exports=$G},function(e,t){"use strict";var n={REMOTE_URL:"http://berndmalle.com/anonymization/adults",REMOTE_TARGET:"education",INPUT_FILE:"./test/io/test_input/house_data.csv",TRIM:"",TRIM_MOD:"",SEPARATOR:"\\s+",SEP_MOD:"g",TARGET_COLUMN:"MEDV",AVERAGE_OUTPUT_RANGES:!0,NR_DRAWS:506,RANDOM_DRAWS:!1,EDGE_MIN:3,EDGE_MAX:10,K_FACTOR:19,ALPHA:1,BETA:0,GEN_WEIGHT_VECTORS:{equal:{range:{CRIM:1/13,ZN:1/13,INDUS:1/13,CHAS:1/13,NOX:1/13,RM:1/13,AGE:1/13,DIS:1/13,RAD:1/13,TAX:1/13,PTRATIO:1/13,B:1/13,LSTAT:1/13}}},VECTOR:"equal"};t.CONFIG=n}]);